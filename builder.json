{
    "name": "aws-crt-dotnet",
    "build_steps": [
        "dotnet build -f netstandard2.0 -v normal -p:PlatformTarget={platform_target} {dotnet_args}",
        "dotnet pack -p:TargetFrameworks=netstandard2.0 -p:PlatformTarget={platform_target} ."
    ],
    "test_steps": [
        "dotnet build tests/tests.csproj -v normal -p:PlatformTarget={platform_target}",
        "dotnet test tests/tests.csproj --no-build -v normal -p:PlatformTarget={platform_target}"
    ],
    "imports": [
        "dotnetcore"
    ],
    "variables": {
        "dotnet_args": ""
    },
    "hosts": {
        "al2": {
            "packages": [
                "libicu",
                "zlib",
                "libcurl"
            ]
        }
    },
    "targets": {
        "linux": {
            "imports": [
                "s2n"
            ],
            "variables": {
                "dotnet_args": "-p:LibCryptoPath={source_dir}/{libcrypto_path}"
            },
            "architectures": {
                "x64": {
                    "build_env": {
                        "AWS_DOTNET_RUNTIME": "linux-x64"
                    },
                    "variables": {
                        "platform_target": "x64"
                    }                    
                },
                "arm64": {
                    "build_env": {
                        "AWS_DOTNET_RUNTIME": "linux-arm64"
                    },
                    "variables": {
                        "platform_target": "arm64"
                    }                    
                }                
            }
        },
        "windows": {
            "architectures": {
                "x86": {
                    "variables": {
                        "platform_target": "x86"
                    }
                },
                "x64": {
                    "variables": {
                        "platform_target": "x64"
                    }
                }
            }
        }
    }
}
